<!DOCTYPE html>
<html lang="en" ng-app="travelApp">
<head>
  <meta charset="UTF-8">
  <title>Hotel Booking</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.3/angular.min.js"></script>
</head>
    <body ng-controller="BookingController as vm" class="bg-light" animate-on-load>
    
      <header class="bg-primary text-white text-center py-4 mb-4 shadow animate__animated animate__fadeInDown">
        <div class="container">
          <div class="d-flex flex-column flex-md-row align-items-center justify-content-between">
            <div class="d-flex align-items-center mb-2 mb-md-0">
              <i class="bi bi-building-fill-check display-5 me-2"></i>
              <h1 class="mb-0">BookNGo</h1>
            </div>
            <nav class="mt-2 mt-md-0">
              <a href="tourbook.html" class="btn btn-outline-light btn-sm me-2"><i class="bi bi-map"></i> Tour Info</a>
              <a href="booking.html" class="btn btn-outline-light btn-sm me-2"><i class="bi bi-calendar2-check"></i> Booking</a>
              <a href="transport.html" class="btn btn-outline-light btn-sm me-2"><i class="bi bi-bus-front"></i> Transport</a>
            </nav>
          </div>
        </div>
      </header>

      <div class="container animate__animated animate__fadeInUp">
        <div class="mb-4">
          <img src="../img/private beach.jpg" alt="Private Beach" class="img-fluid rounded shadow" style="max-height: 260px; width: 100%; object-fit: cover;">
        </div>
  <div class="card p-4 shadow-lg mb-4 border-0 animate__animated animate__fadeIn position-relative" style="background: none;">
    <div style="position:absolute;top:0;left:0;width:100%;height:100%;background:url('../img/Island.jpg') center/cover no-repeat;opacity:0.08;z-index:0;"></div>
    <div style="position:relative;z-index:1;">
          <div class="d-flex align-items-center mb-3">
            <i class="bi bi-building-fill-check text-primary display-6 me-2"></i>
            <h4 class="mb-0">Hotel Booking</h4>
          </div>
          <div class="mb-3">
            <span class="badge bg-info text-dark me-2"><i class="bi bi-building"></i> {{vm.form.hotel}}</span>
            <span class="badge bg-secondary"><i class="bi bi-geo-alt"></i> {{vm.form.city}}</span>
          </div>
          <div class="row">
            <!-- Filters (left) -->
            <div class="col-md-4">
              <div class="card p-3 mb-4">
                <h5>Filter Hotels</h5>
                <div class="mb-3">
                  <label class="form-label">City</label>
                  <select ng-model="vm.filter.city" class="form-select">
                    <option value="">All Cities</option>
                    <option ng-repeat="city in vm.cities" value="{{city}}">{{city}}</option>
                  </select>
                </div>
                <div class="mb-3">
                  <label class="form-label">Max Price</label>
                  <input type="number" ng-model="vm.filter.price" class="form-control" placeholder="No limit">
                </div>
                <button class="btn btn-primary w-100" ng-click="vm.applyFilter()">Apply Filter</button>
                <button class="btn btn-secondary w-100 mt-2" ng-click="vm.clearFilter()">Clear Filter</button>
              </div>
            </div>
            <!-- Hotel Cards (right) -->
            <div class="col-md-8">
              <div class="row">
                <div class="col-md-6 mb-4" ng-repeat="hotel in vm.filteredHotels">
                  <div class="card h-100 shadow-sm">
                    <img ng-src="{{hotel.image}}" class="card-img-top" alt="{{hotel.name}}" style="height:180px;object-fit:cover;">
                    <div class="card-body">
                      <h5 class="card-title">{{hotel.name}}</h5>
                      <p class="card-text mb-1"><i class="bi bi-geo-alt"></i> {{hotel.city}}</p>
                      <p class="card-text mb-1"><i class="bi bi-currency-rupee"></i> {{hotel.price}}</p>
                      <p class="card-text">{{hotel.description}}</p>
                      <button class="btn btn-success w-100 mt-2" ng-click="vm.goToBookingForm(hotel)"><i class="bi bi-check-circle"></i> Book</button>
                    </div>
                  </div>
                </div>
                <div ng-if="vm.filteredHotels.length === 0" class="text-center text-muted mt-5">
                  <i class="bi bi-exclamation-circle"></i> No hotels found for selected filters.
                </div>
              </div>
            </div>
      </div>
    </div>
        </div>
        
          <script>
           angular.module("travelApp", [])
  .controller("BookingController", function($scope, $http, $window) {
    var vm = this;
    // Realistic hotel data (Indian cities)
    vm.hotels = [
      { name: "The Residency Towers", city: "Chennai", price: 3200, image: "../img/private beach.jpg", description: "Luxury stay in Chennai city center." },
      { name: "Taj Coromandel", city: "Chennai", price: 5400, image: "../img/sea shore.jpg", description: "5-star hotel with fine dining." },
      { name: "Le Meridien", city: "Coimbatore", price: 4100, image: "../img/mountain beach.jpg", description: "Modern hotel near airport." },
      { name: "Radisson Blu", city: "Bangalore", price: 4800, image: "../img/Island.jpg", description: "Business hotel in Bangalore." },
      { name: "Hyatt Place", city: "Hyderabad", price: 3900, image: "../img/sea shore.jpg", description: "Comfort and convenience in Hyderabad." },
      { name: "Sangam Hotel", city: "Trichy", price: 2500, image: "../img/private beach.jpg", description: "Popular hotel near Srirangam." },
      { name: "Heritage Madurai", city: "Madurai", price: 3700, image: "../img/Island.jpg", description: "Resort-style stay in Madurai." }
    ];
    vm.cities = Array.from(new Set(vm.hotels.map(h => h.city)));
    vm.filter = { city: '', price: '' };
    vm.filteredHotels = vm.hotels.slice();

    vm.applyFilter = function() {
      vm.filteredHotels = vm.hotels.filter(function(hotel) {
        var cityMatch = !vm.filter.city || hotel.city === vm.filter.city;
        var priceMatch = !vm.filter.price || hotel.price <= vm.filter.price;
        return cityMatch && priceMatch;
      });
    };
    vm.clearFilter = function() {
      vm.filter = { city: '', price: '' };
      vm.filteredHotels = vm.hotels.slice();
    };
    // Redirect to booking form with hotel info
    vm.goToBookingForm = function(hotel) {
      localStorage.setItem('selectedHotel', JSON.stringify(hotel));
      $window.location.href = 'bookhotel-form.html';
    };
    vm.submitBooking = function() {
      if (!vm.booking.name || !vm.booking.phone || !vm.booking.address || !vm.booking.city) {
        alert('Please fill all details.');
        return;
      }
      var bookingData = {
        name: vm.booking.name,
        phone: vm.booking.phone,
        address: vm.booking.address,
        city: vm.booking.city,
        hotel: vm.selectedHotel.name,
        hotelCity: vm.selectedHotel.city,
        price: vm.selectedHotel.price
      };
      $http.post('http://localhost:5000/api/bookedhotels', bookingData)
        .then(function() {
          alert('Hotel booked successfully!');
          var modal = bootstrap.Modal.getInstance(document.getElementById('hotelBookingModal'));
          modal.hide();
        })
        .catch(function() {
          alert('Booking failed. Please try again.');
        });
    };
  });
          </script>
    </body>
    <!-- Hotel Booking Modal -->
    <div class="modal fade" id="hotelBookingModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <form class="modal-content" ng-submit="vm.submitBooking()" ng-controller="BookingController as vm">
          <div class="modal-header">
            <h5 class="modal-title">Book Hotel: {{vm.selectedHotel.name}}</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <div class="mb-2"><strong>Description:</strong> {{vm.selectedHotel.description}}</div>
            <div class="mb-2"><strong>City:</strong> {{vm.selectedHotel.city}}</div>
            <div class="mb-2"><strong>Price:</strong> â‚¹{{vm.selectedHotel.price}}</div>
            <hr>
            <div class="mb-3">
              <label>Name</label>
              <input type="text" class="form-control" ng-model="vm.booking.name" required>
            </div>
            <div class="mb-3">
              <label>Phone No</label>
              <input type="text" class="form-control" ng-model="vm.booking.phone" required>
            </div>
            <div class="mb-3">
              <label>Address</label>
              <input type="text" class="form-control" ng-model="vm.booking.address" required>
            </div>
            <div class="mb-3">
              <label>City</label>
              <input type="text" class="form-control" ng-model="vm.booking.city" required>
            </div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-primary">Book</button>
          </div>
        </form>
      </div>
    </div>
    </html>